{% import '::macros.html.twig' as macros %}
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<link href="{{ path('sonata_news_archive', { _format: 'rss' }) }}" rel="alternate" title="{{ 'sitename'|trans }}" type="application/rss+xml" />

	<link href="{{ asset('favicon.png') }}" rel="icon" type="image/png" />
	<link href="{{ asset('favicon.ico') }}" rel="shortcut icon" type="image/x-icon" />

	<link href="{{ asset('bundles/eurocoin/css/bootstrap.css') }}" rel="stylesheet" type="text/css" />
	<link href="{{ asset('bundles/eurocoin/css/bootstrap-responsive.css') }}" rel="stylesheet" type="text/css" />
	<link href="{{ asset('bundles/eurocoin/css/style.css') }}" rel="stylesheet" type="text/css" />

	<meta charset="UTF-8" />
	<meta name="description" content="{% block meta_description %}{{ 'site_description'|trans }}{% endblock %}" />
	<meta name="keywords" content="{{ 'site_keywords'|trans }}" />
	<meta name="robots" content="index, follow" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<title>
		{% block title %}{% endblock %}

		{% if block('title') %}
			&bull;
		{% endif %}

		{{ 'sitename'|trans }}
	</title>

	{% if app.environment == 'prod' %}
		<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-34775644-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
		</script>
	{% endif %}
</head>
<body>
{% set locale, route = 'en', app.request.get('_route') %}
{% if app.user.locale is defined %}
	{% set locale = app.user.locale %}
{% endif %}

<div class="navbar navbar-fixed-top">
	<div class="navbar-inner">
		<div class="container-fluid">
			<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</a>

			<a class="brand" href="{{ path('welcome') }}">{{ 'sitename'|trans }}</a>

			<div class="nav-collapse">
				<ul class="nav">
					<li{{ macros.is_active(['countries_list']) }}><a href="{{ path('countries_list') }}">{{ 'countries.list'|trans }}</a></li>
					<li{{ macros.is_active(['coin_collection1', 'coin_collection2', 'coin_collection3']) }}><a href="{{ path('coin_collection1') }}">{{ 'coin.collection'|trans }}</a></li>

					{% if app.user %}
						<li{{ macros.is_active(['exchange_coins_request', 'exchange_coins_suggest', 'exchange_choose_user', 'exchange_list', 'exchange_list_all', 'exchange_show']) }}><a href="{{ path('exchange_list') }}">{{ 'exchanges'|trans }}</a></li>
					{% endif %}

					<li{{ macros.is_active(['coin_stats']) }}><a href="{{ path('coin_stats') }}">{{ 'stats'|trans }}</a></li>
				</ul>
				<ul class="nav pull-right">
					{% if app.user %}
						{#
						{% set count = 3 %}
						<li><a href="{{ path('pm_list') }}" title="{{ 'pm.unread_count'|transchoice(count, { '%count%': count }) }}"><span class="badge badge-warning">{{ count }}</span></a></li>
						#}

						<li class="{{ macros.is_active(['pm_list', 'pm_list_archives', 'pm_read', 'show_profile', 'show_user_collection1', 'show_user_collection2', 'show_user_collection3', 'show_user_stats'], 'false') }} dropdown">
							<a class="dropdown-toggle" href="#" data-toggle="dropdown">
								{{ app.user }} <b class="caret"></b>
							</a>
							<ul class="dropdown-menu">
								{% if is_granted('ROLE_ADMIN') %}
									<li><a href="{{ path('sonata_admin_dashboard') }}">{{ 'administration'|trans }}</a></li>
									<li class="divider"></li>
								{% endif %}

								<li{{ macros.is_active(['show_profile', 'show_user_collection1', 'show_user_collection2', 'show_user_collection3', 'show_user_stats']) }}><a href="{{ path('show_profile', { id: app.user.id }) }}">{{ 'user.profile'|trans }}</a></li>
								<li{{ macros.is_active(['pm_list', 'pm_list_archives', 'pm_read']) }}><a href="{{ path('pm_list') }}">{{ 'pm.user_pm'|trans }}</a></li>
								<li class="divider"></li>
								<li><a href="{{ path('fos_user_security_logout') }}">{{ 'user.logout'|trans }}</a></li>
							</ul>
						</li>
					{% else %}
						<li{{ macros.is_active(['fos_user_security_login']) }}><a href="#modal-login" data-toggle="modal">{{ 'user.login'|trans }}</a></li>
						<li{{ macros.is_active(['fos_user_registration_register']) }}><a href="#modal-register" data-toggle="modal">{{ 'user.register'|trans }}</a></li>
					{% endif %}
				</ul>
			</div>
		</div>
	</div>
</div>

<div class="container-fluid">
	{% for message in app.session.flashbag.get('success') %}
	<div class="alert alert-success fade in">
		<button class="close" type="button" data-dismiss="alert">×</button>

		<strong>{{ 'congratulation'|trans }}</strong> {{ message|trans }}
	</div>
	{% endfor %}

	{% for message in app.session.flashbag.get('info') %}
	<div class="alert alert-info fade in">
		<button class="close" type="button" data-dismiss="alert">×</button>

		<strong>{{ 'information'|trans }}</strong> {{ message|trans }}
	</div>
	{% endfor %}

	{% for message in app.session.flashbag.get('error') %}
	<div class="alert alert-error fade in">
		<button class="close" type="button" data-dismiss="alert">×</button>

		<strong>{{ 'error'|trans }}</strong> {{ message|trans }}
	</div>
	{% endfor %}

	{% block body %}{% endblock %}
</div>

<div class="hidden-phone navbar navbar-fixed-bottom">
	<div class="navbar-inner">
		<div class="container-fluid">
			<a class="btn btn-small" id="footer-toggle" data-toggle="collapse" data-target="#footer-extend">
				<i class="icon-plus"></i> {{ 'personnal_menu'|trans }}
			</a>

			<p class="navbar-text pull-right" id="footer-short">
				{{ 'site_created_by'|trans({
					'%name%': 'M.Gaetan89',
					'%path%': path('show_profile', { id: 1 }),
				})|raw }}

				{% if route in ['coin_collection1', 'coin_collection2', 'coin_collection3'] %}
					 &mdash;
					{{ 'coin_data_provider'|trans({
						'%name%': 'Euro Auflagen',
						'%path%': 'http://euro-auflagen.de/',
					})|raw }}
				{% endif %}
			</p>

			<div class="collapse" id="footer-extend">
				<hr />

				<div class="row-fluid">
					<div class="span10">
						<p>
							<strong>{{ 'coin.collection'|trans }} &mdash;</strong>

								{% for i in 1..3 %}
									<a href="{{ path('coin_collection' ~ i) }}">{{ ('coin.type' ~ i)|trans }}</a> &bull;
								{% endfor %}

								<a href="{{ path('coin_stats') }}">{{ 'stats'|trans }}</a>
						</p>

						{% if app.user %}
							<p>
								<strong>{{ 'exchanges'|trans }} &mdash;</strong>

									<a href="{{ path('exchange_choose_user') }}">{{ 'exchange.new'|trans }}</a> &bull;
									<a href="{{ path('exchange_list') }}">{{ 'exchanges.pending'|trans }}</a> &bull;
									<a href="{{ path('exchange_list_all') }}">{{ 'exchanges.all'|trans }}</a>
							</p>
							<p>
								<strong>{{ app.user.username }} &mdash;</strong>

									{% if is_granted('ROLE_ADMIN') %}
										<a href="{{ path('sonata_admin_dashboard') }}">{{ 'administration'|trans }}</a> &bull;
									{% endif %}

									<a href="{{ path('show_profile', { id: app.user.id }) }}">{{ 'user.profile'|trans }}</a> &bull;
									<a href="{{ path('pm_list') }}">{{ 'pm.user_pm'|trans }}</a> &bull;
									<a href="{{ path('fos_user_security_logout') }}">{{ 'user.logout'|trans }}</a>
							</p>
						{% else %}
							<p>
								<strong>{{ 'user.account'|trans }} &mdash;</strong>

								<a href="{{ path('fos_user_security_login') }}" rel="nofollow">{{ 'user.login'|trans }}</a> &bull;
								<a href="{{ path('fos_user_registration_register') }}" rel="nofollow">{{ 'user.register'|trans }}</a>
							</p>
						{% endif %}

						<p>
							<strong>{{ 'sitename'|trans }} &mdash;</strong>

								<a href="{{ path('contact') }}">{{ 'contact'|trans }}</a> &bull;
								<a href="{{ path('page_copyright') }}">{{ 'copyright'|trans }}</a> &bull;
								<a href="{{ path('page_links') }}">{{ 'links'|trans }}</a> &bull;
								<a href="https://github.com/MGaetan89/Euro/wiki" target="_blank">{{ 'copyright.contribute_on_github'|trans }}</a>
						</p>
					</div>
					<div class="span2" style="text-align: center;">
						<div class="fb-like" data-href="http://www.eurocoin-mania.eu/" data-send="false" data-layout="button_count" data-width="160" data-show-faces="false" data-action="recommend"></div>
						<a href="https://twitter.com/share" class="twitter-share-button" data-via="EuroCoinMania" data-lang="{{ locale }}"></a>
						<div class="g-plusone" data-size="medium"></div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

{% if not app.user %}
	{% if route != 'fos_user_security_login' %}
		<div class="fade hide modal" id="modal-login" tabindex="-1">
			<div class="modal-header">
				<button class="close" type="button" data-dismiss="modal">×</button>

				<h3>{{ 'user.login'|trans }}</h3>
			</div>
			<div class="modal-body">
				{% render 'FOSUserBundle:Security:login' %}
			</div>
		</div>
	{% endif %}

	{% if route != 'fos_user_registration_register' %}
		<div class="fade hide modal" id="modal-register" tabindex="-1">
			<div class="modal-header">
				<button class="close" type="button" data-dismiss="modal">×</button>

				<h3>{{ 'user.register'|trans }}</h3>
			</div>
			<div class="modal-body">
				{% render 'FOSUserBundle:Registration:register' %}
			</div>
		</div>
	{% endif %}
{% endif %}

<div id="fb-root"></div>
<script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//connect.facebook.net/fr_FR/all.js#xfbml=1&appId=303118733036336';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','facebook-jssdk');</script>
<script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','twitter-wjs');</script>
<script type="text/javascript">
window.___gcfg = {lang: '{{ locale }}'};

(function() {
	var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
	po.src = 'https://apis.google.com/js/plusone.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
})();
</script>
<script src="{{ asset('bundles/eurocoin/js/jquery.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/eurocoin/js/bootstrap.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/eurocoin/js/app.js') }}" type="text/javascript"></script>
{% block javascript %}{% endblock %}
</body>
</html>
