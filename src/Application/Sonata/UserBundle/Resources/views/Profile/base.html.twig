{% extends '::base.html.twig' %}

{% if user is not defined %}
	{% set user = app.user %}
{% endif %}

{% block title %}{{ user.username }}{% endblock %}

{% block body %}
<h2 class="page-header">
	{{ block('title') }}

	{% if user.fullname %}
		<small>{{ user.fullname }}</small>
	{% endif %}
</h2>

<div class="row-fluid">
	<div class="span3">
		{% if app.request.get('_route') in ['show_profile', 'show_user_stats'] and gravatar_exists(user.email) %}
			<div style="margin-bottom: 10px; padding-left: 20px;">
				<img alt="{{ user.username }}" class="img-polaroid" src="{{ gravatar(user.email) }}" title="{{ user.username }}" />
			</div>
		{% endif %}

		<div class="dropdown">
			<ul class="dropdown-menu" style="display: block; position: static;">
				{% if app.request.get('_route') in ['show_user_collection', 'show_user_collection_collector'] %}
					{% include 'ApplicationSonataUserBundle:Profile:collection_menu.html.twig' %}
				{% endif %}

				<li class="nav-header">{{ 'actions'|trans }}</li>

				<li{{ macros.is_active(['show_profile']) }}>
					<a href="{{ path('show_profile', { id: user.id }) }}">
						<i class="icon-chevron-right"></i>
						{{ 'user.show_profile'|trans }}
					</a>
				</li>
				<li{{ macros.is_active(['show_user_collection', 'show_user_collection_collector']) }}>
					<a href="{{ path('show_user_collection', { user_id: user.id }) }}">
						<i class="icon-chevron-right"></i>
						{{ 'user.show_collection'|trans }}
					</a>
				</li>
				<li{{ macros.is_active(['show_user_stats']) }}>
					<a href="{{ path('show_user_stats', { id: user.id }) }}">
						<i class="icon-chevron-right"></i>
						{{ 'user.show_stats'|trans }}
					</a>
				</li>

				{% if app.user.id == user.id %}
					<li class="divider">

					<li{{ macros.is_active(['sonata_user_profile_edit']) }}>
						<a href="{{ path('sonata_user_profile_edit') }}">
							<i class="icon-chevron-right"></i>
							{{ 'user.edit_profile'|trans }}
						</a>
					</li>
					<li{{ macros.is_active(['sonata_user_profile_edit_authentication']) }}>
						<a href="{{ path('sonata_user_profile_edit_authentication') }}">
							<i class="icon-chevron-right"></i>
							{{ 'user.edit_authentication'|trans }}
						</a>
					</li>
					<li>
						<a href="{{ path('fos_user_security_logout') }}">
							<i class="icon-chevron-right"></i>
							{{ 'user.logout'|trans }}
						</a>
					</li>
				{% endif %}
			</ul>
		</div>
	</div>
	<div class="span9">
		{% block content %}{% endblock %}
	</div>
</div>
{% endblock %}
