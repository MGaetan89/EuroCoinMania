{% extends '::base.html.twig' %}

{% block title %}
	{% if collector %}
		{{ 'coin.list_collector'|trans }}
	{% else %}
		{{ 'coin.list_coin'|trans }}
	{% endif %}
{% endblock %}

{% block body %}
{% set total_coins = 0 %}

<div class="page-header">
	<h1>
		{{ block('title') }}
		<small>
			{% if collector %}
				<a href="{{ path('coin') }}">{{ 'coin.circulation'|trans }}</a>
			{% else %}
				<a href="{{ path('coin_collector') }}">{{ 'coin.collector'|trans }}</a>
			{% endif %}
		</small>
	</h1>
</div>

{% if coins %}
{% set has_filter = false %}
{% for name, value in filters if value|trim %}
	{% set has_filter = true %}
{% endfor %}

{% if commemoratives or countries or values or years or has_filter %}
<div class="row-fluid">
	<div class="span2">
		<div class="nav nav-list">
			<div class="nav-header">{{ 'filters'|trans }}</div>
		</div>

		{% if commemoratives or countries or values or years %}
		<div class="accordion" id="filters">
			{% if countries %}
			<div class="accordion-group">
				<div class="accordion-heading">
					<a class="accordion-toggle" data-parent="#filters" data-toggle="collapse" href="#filter_country">{{ 'coin.country'|trans }}</a>
				</div>
				<div class="accordion-body collapse" id="filter_country">
					<div class="accordion-inner">
						<ul>
							{% for id, country in countries %}
							<li><a href="{{ path('coin_filter', filters|merge({ country: id })) }}">{{ country|trans }}</a></li>
							{% endfor %}
						</ul>
					</div>
				</div>
			</div>
			{% endif %}

			{% if years %}
			<div class="accordion-group">
				<div class="accordion-heading">
					<a class="accordion-toggle" data-parent="#filters" data-toggle="collapse" href="#filter_year">{{ 'coin.year'|trans }}</a>
				</div>
				<div class="accordion-body collapse" id="filter_year">
					<div class="accordion-inner">
						<ul>
							{% for year in years %}
							<li><a href="{{ path('coin_filter', filters|merge({ year: year })) }}">{{ year }}</a></li>
							{% endfor %}
						</ul>
					</div>
				</div>
			</div>
			{% endif %}

			{% if values %}
			<div class="accordion-group">
				<div class="accordion-heading">
					<a class="accordion-toggle" data-parent="#filters" data-toggle="collapse" href="#filter_value">{{ 'coin.value'|trans }}</a>
				</div>
				<div class="accordion-body collapse" id="filter_value">
					<div class="accordion-inner">
						<ul>
							{% for id, value in values %}
							<li><a href="{{ path('coin_filter', filters|merge({ value: id })) }}">{{ value }}</a></li>
							{% endfor %}
						</ul>
					</div>
				</div>
			</div>
			{% endif %}

			{% if commemoratives %}
			<div class="accordion-group">
				<div class="accordion-heading">
					<a class="accordion-toggle" data-parent="#filters" data-toggle="collapse" href="#filter_commemorative">{{ 'coin.commemorative'|trans }}</a>
				</div>
				<div class="accordion-body collapse" id="filter_commemorative">
					<div class="accordion-inner">
						<ul>
							<li><a href="{{ path('coin_filter', filters|merge({ commemorative: 1 })) }}">{{ 'yes'|trans }}</a></li>
							<li><a href="{{ path('coin_filter', filters|merge({ commemorative: 0 })) }}">{{ 'no'|trans }}</a></li>
						</ul>
					</div>
				</div>
			</div>
			{% endif %}
		</div>
		{% endif %}

		{% for name, value in filters if value|trim %}
			<div class="control-group">
				<div class="input-append">
					<span class="span1 uneditable-input">{{ ('coin.' ~ name)|trans }}</span><a class="btn btn-info" href="{{ path('coin_filter', filters|reset(name)) }}" title="{{ 'action.reset'|trans }}"><i class="icon-white icon-remove"></i></a>
				</div>
			</div>
		{% endfor %}

		{% if has_filter %}
		<a class="btn" href="{{ path('coin') }}">{{ 'action.reset_all'|trans }}</a>
		{% endif %}
	</div>

	<div class="span10">
		{% endif %}

		{% if collector %}
			{% include "EuroCoinBundle:Coin:list_collector.html.twig" %}
		{% else %}
			{% include "EuroCoinBundle:Coin:list_coin.html.twig" %}
		{% endif %}

		{% if commemoratives or countries or values or years or has_filter %}
	</div>
</div>
{% endif %}

{% if app.user %}
<script src="{{ asset('bundles/eurocoin/js/collection.js') }}" type="text/javascript"></script>
{% endif %}
{% else %}
<div class="alert alert-info">
	{{ 'coin.none'|trans }}
</div>
{% endif %}
{% endblock %}
