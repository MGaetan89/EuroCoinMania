{% extends '::base.html.twig' %}

{% block title %}{{ 'country.list'|trans }}{% endblock %}

{% block body %}
<div class="page-header">
	<h1>{{ block('title') }}</h1>
</div>

{% if countries %}
<div class="row-fluid">
	<div class="span5">
		<div class="well">
			<div id="map"></div>
		</div>
	</div>

	<div class="span7">
		<table class="table table-bordered table-striped">
		<thead>
			<tr>
				<th>{{ 'country.name'|trans }}</th>
				<th>{{ 'country.join_date'|trans }}</th>
				<th>{{ 'country.formercurrency'|trans }}</th>
				<th>{{ 'country.change_rate'|trans }}</th>
			</tr>
		</thead>
		<tbody>
		{% for country in countries %}
			<tr>
				<td><a href="{{ path('country_show', { 'id': country.id }) }}">{{ country.name|trans }}</a></td>
				<td>{{ country.joindate|date('d/m/Y') }}</td>
				<td>{{ country.formercurrency|trans }}</td>
				<td>1 &euro; = {{ country.exchangerate }} {{ country.formercurrencyiso }}</td>
			</tr>
		{% endfor %}
		</tbody>
		</table>
	</div>
</div>
{% else %}
<div class="alert alert-info">
	{{ 'country.none'|trans }}
</div>
{% endif %}
{% endblock %}

{% block javascript %}
{% set startColor, endColor = '#0088CC', '#005580' %}
<script src="{{ asset('bundles/eurocoin/js/jquery.svg.js') }}" type="text/javascript"></script>
<script type="text/javascript">
$(function () {
	$('#map').svg({
		loadURL: '{{ asset('bundles/eurocoin/images/europe.svg') }}',
		onLoad: function () {
			{% for country in countries %}
				{% if country.nameiso %}
					$('#{{ country.nameiso }}', this)
						.css('fill', '{{ startColor }}')
						.attr('title', '{{ country.name|trans }}')
						.click(function () {
							location.href = '{{ path('country_show', { 'id': country.id }) }}';
						})
						.hover(function () {
							$(this).css('fill', '{{ endColor }}');
						}, function () {
							$(this).css('fill', '{{ startColor }}');
						});
				{% endif %}
			{% endfor %}
		}
	});
});
</script>
{% endblock %}
